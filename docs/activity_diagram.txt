@startuml
toml <- "los_script.py" as py: Load Toml
activate toml
activate py
toml --> py : Read environment variables
deactivate toml
broker <- py : Request latest dataset
activate broker
broker --> py : Response latest dataset
deactivate broker
py -> temp : create temporary directory
activate temp
py -> temp : save latest dataset
py -> "R-script" as r : execute
activate r
r -> temp : Get latest dataset
r <-- temp : Return latest dataset
r -> r : Calculate LOS
r -> temp : Store result
r --> py : Notify finished execution
deactivate r
py -> temp : Get R-script result
temp --> py : Return result
py -> py : Upload result to SFTP server
py -> temp : clean
deactivate temp
deactivate py


@enduml